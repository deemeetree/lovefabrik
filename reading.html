<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>LOVEFABRIK</title>
    <link rel='stylesheet' href='style.css' />



</head>
<body>


<div id="graph-container"></div>

<div id="NW"><br><br><br><a href="javascript:" id="water">❤ emotional & intuitive</a></div>
<div id="NE"><br><br><br><a href="javascript:" id="air">❤ intellectual & spiritual</a><br></div>
<div id="SW"><br><br><br><a href="javascript:" id="earth">❤ corporeal & material</a></div>
<div id="SE"><br><br><br><a href="javascript:" id="fire">❤ sexual & creative</a></div>


<script src="js/jquery.min.js"></script>
<script src="js/sigma.min.js"></script>
<script src="js/sigma.parsers.gexf.min.js"></script>
<script src="js/sigma.parsers.json.min.js"></script>
<script src="js/sigma.layout.forceAtlas2.js"></script>
<script src="js/sigma.plugins.animate.min.js"></script>
<script src="js/sigma.plugins.neighborhoods.js"></script>






<script>
    ;(function(){




        myAudio = new Audio('rocket.ogg');
        if (typeof myAudio.loop == 'boolean')
        {
            myAudio.loop = true;
        }
        else
        {
            myAudio.addEventListener('ended', function() {
                this.currentTime = 0;
                this.play();
            }, false);
        }
        myAudio.play();


        var s = new sigma({
                    container: 'graph-container',
                    renderer: {
                        container: document.getElementById('graph-container'),
                        type: 'canvas'
                    },
                    settings: {
                        minNodeSize: 12,
                        maxNodeSize: 40,
                        minEdgeSize: 0.5,
                        maxEdgeSize: 3,
                        labelThreshold: 3,
                        labelSize: 'proportional',
                        labelSizeRatio: 1.3,
                        labelColor: 'node'

                    }
                }),
                db = new sigma.plugins.neighborhoods();



        db.load('divination.json', function() {

            // This is a fix for JSON
            // Sigma requires that nodes have X, Y, Size and Color properties which our JSON doesn't have. So we add them.
            // We also make the initial graph layout circular, so that ForceAtlas always looks the same

            // Out function to initialize sigma on a new neighborhood:
            function refreshGraph(centerNodeId) {
                // First, let's stop the ForceAtlas2 algorithm:
                s.stopForceAtlas2();

                // Restart the camera:
                s.camera.goTo({
                    x: 0,
                    y: 0,
                    angle: 0,
                    ratio: 1
                });

                // Empty the graph:
                s.graph.clear();

                // Read the graph:
                s.graph.read(db.neighborhood(centerNodeId));

                // Randomize the positions of the nodes and initialize their size:
                var i,
                        nodes = s.graph.nodes(),
                        len = nodes.length;

                for (i = 0; i < len; i++) {
                    nodes[i].x = Math.cos(Math.PI * 2 * i / len);
                    nodes[i].y = Math.sin(Math.PI * 2 * i / len);
                    nodes[i].size = s.graph.degree(nodes[i].id);
                    nodes[i].color = '#555';
                }


                // Refresh the display:
                s.refresh();

                // Start the ForceAtlas2 algorithm:
                s.startForceAtlas2();

                setTimeout(function() {
                    s.stopForceAtlas2();
                },7000);
            }

            // Let's now bind this new function to the "clickNode" event:
            s.bind('clickNode', function(event) {
                if (!event.data.node.center)
                    refreshGraph(event.data.node.id);
            });

            $("#earth").on('click', function(e) {

                // And finally, let's initialize the first graph:
                refreshGraph('dba3e476-ab63-11e3-80a6-8f3ba3a3f2e7');
                $( '#SW' ).fadeTo( "fast", $('#SW').css("opacity") == "1" ? "0.5" : "1");


            });

            $("#fire").on('click', function(e) {

                // And finally, let's initialize the first graph:
                refreshGraph('36493384-d486-11e3-a954-ab35be27f3fc');

                $( '#SE' ).fadeTo( "fast", $('#SE').css("opacity") == "1" ? "0.5" : "1");

            });


            $("#air").on('click hover', function(e) {

                // And finally, let's initialize the first graph:
                refreshGraph('90e3ada6-cf8f-11e3-a954-ab35be27f3fc');
                $( '#NE' ).fadeTo( "fast", $('#NE').css("opacity") == "1" ? "0.5" : "1");
            });

            $("#water").on('click', function(e) {

                // And finally, let's initialize the first graph:
                refreshGraph('95c3e231-dae7-11e3-910c-5b1996442876');

                $( '#NW' ).fadeTo( "fast", $('#NW').css("opacity") == "1" ? "0.5" : "1");

            });


        });








    })();
</script>

</body>
</html>